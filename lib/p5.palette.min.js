/*! p5.palette.js (0.1.0): a p5.js library to manage color palettes. Author: Gustavo Mandolesi, license: ISC, 2022-11-03 */
class Palette{constructor(t,o){this.P=t,this.colors=o||[],this.index=0}add(t){this.colors.push(t)}addAnalogousColors(){var o=this.getAnalogous(),e=[];for(let t=0;t<this.size();t++)e.push(o.get(2*t)),e.push(this.get(t)),e.push(o.get(2*t+1));this.colors=Array.from(e)}addComplementaryColors(){var o=this.getComplementary(),e=[];for(let t=0;t<this.size();t++)e.push(this.get(t)),e.push(o.get(t));this.colors=Array.from(e)}addSplitComplementaryColors(){var o=this.getSplitComplementary(),e=[];for(let t=0;t<this.size();t++)e.push(o.get(2*t)),e.push(this.get(t)),e.push(o.get(2*t+1));this.colors=Array.from(e)}addTriadicColors(){var o=this.getTriadic(),e=[];for(let t=0;t<this.size();t++)e.push(o.get(2*t)),e.push(this.get(t)),e.push(o.get(2*t+1));this.colors=Array.from(e)}getAnalogous(){const e=[];return this.colors.forEach(t=>{var[t,o]=this.#getAnalogous(t);e.push(t),e.push(o)}),new Palette(this.P,e)}getComplementary(){const o=[];return this.colors.forEach(t=>{o.push(this.#getComplementary(t))}),new Palette(this.P,o)}getSplitComplementary(){const e=[];return this.colors.forEach(t=>{var[t,o]=this.#getSplitComplementary(t);e.push(t),e.push(o)}),new Palette(this.P,e)}getTriadic(){const e=[];return this.colors.forEach(t=>{var[t,o]=this.#getTriadic(t);e.push(t),e.push(o)}),new Palette(this.P,e)}clone(){return this.P.createPalette(this.colors)}current(){return this.colors[this.index]}darken(){this.P.push(),this.P.colorMode(HSB);var o=[];for(let t=0;t<this.size();t++){var e=this.get(t);o.push(this.P.color(this.P.hue(e),this.P.saturation(e),.9*this.P.brightness(e)))}this.colors=Array.from(o),this.P.pop()}draw(t){var{x:t=0,y:o=0,width:e=100,height:s=50,showIndex:r=!1,drawBorder:i=!1,borderColor:l=0,borderWeight:a=1}=t;this.P.push(),this.P.noStroke();let n=t;var h,c=this.colors.length,p=e/c;for(let t=0;t<c;t++)this.P.fill(this.colors[t]),t===this.index&&r?(h=s/5,this.P.rect(n,o+h,p,3*h)):this.P.rect(n,o,p,s),n+=p;i&&(this.P.noFill(),this.P.stroke(l),this.P.strokeWeight(a),this.P.rect(t,o,e,s)),this.P.pop()}get(t){return t?this.colors[t]:this.colors[this.index]}lighten(){this.P.push(),this.P.colorMode(HSB);var o=[];for(let t=0;t<this.size();t++){var e=this.get(t);o.push(this.P.color(this.P.hue(e),.9*this.P.saturation(e),1.1*this.P.brightness(e)))}this.colors=Array.from(o),this.P.pop()}log(){this.colors.forEach(t=>{t=t.toString("#rrggbb");console.log("%c%s%c %s","background: #222; color: "+t,"■■■■■■■■■■■■■■■■■■■■","color:gray",""+t)})}next(){return++this.index===this.colors.length&&(this.index=0),this.colors[this.index]}previous(){return--this.index<0&&(this.index=this.colors.length-1),this.colors[this.index]}reset(){this.index=0}reverse(){this.colors.reverse()}size(){return this.colors.length}shuffle(t){const o=t||Math.random;this.colors=this.colors.sort(()=>o()-.5)}sortByBrightness(){this.colors=this.colors.sort((t,o)=>this.P.brightness(t)===this.P.brightness(o)?0:this.P.brightness(t)>this.P.brightness(o)?1:-1)}sortByLightness(){this.colors=this.colors.sort((t,o)=>this.P.lightness(t)===this.P.lightness(o)?0:this.P.lightness(t)>this.P.lightness(o)?1:-1)}sortBySaturation(){this.colors=this.colors.sort((t,o)=>this.P.saturation(t)===this.P.saturation(o)?0:this.P.saturation(t)>this.P.saturation(o)?1:-1)}toHexString(){return this.toString().replaceAll("#","")}toString(t){const o=t&&t.separator||"-",e=t&&t.format||"#rrggbb";let s="";return this.colors.forEach(t=>{s=(s+=t.toString(e))+o}),s=s.slice(0,-1)}#getAnalogous(t){this.P.push(),this.P.colorMode(HSB);var o=this.P.color((this.P.hue(t)+330)%360,this.P.saturation(t),this.P.brightness(t)),t=this.P.color((this.P.hue(t)+30)%360,this.P.saturation(t),this.P.brightness(t));return this.P.pop(),[o,t]}#getComplementary(t){this.P.push(),this.P.colorMode(HSB);t=this.P.color((this.P.hue(t)+180)%360,this.P.saturation(t),this.P.brightness(t));return this.P.pop(),t}#getSplitComplementary(t){this.P.push(),this.P.colorMode(HSB);var o=this.P.color((this.P.hue(t)+150)%360,this.P.saturation(t),this.P.brightness(t)),t=this.P.color((this.P.hue(t)+210)%360,this.P.saturation(t),this.P.brightness(t));return this.P.pop(),[o,t]}#getTetradic(t){}#getTriadic(t){this.P.push(),this.P.colorMode(HSB);var o=this.P.color((this.P.hue(t)+120)%360,this.P.saturation(t),this.P.brightness(t)),t=this.P.color((this.P.hue(t)+240)%360,this.P.saturation(t),this.P.brightness(t));return this.P.pop(),[o,t]}}const COLORMIND_API_URL="http://colormind.io/api/",COLOURLOVERS_API_URL="http://www.colourlovers.com/api/palettes/random?format=json&numResults=1&resultOffset=",STORAGE_KEY="palettes";function invalidValue(t,o){throw new Error(`Invalid ${t} value: `+o)}function jsonp(t,o){const e=o.callbackName||"callback",s=o.onSuccess||function(){},r=o.onTimeout||function(){};o=o.timeout||10;const i=window.setTimeout(function(){window[e]=function(){},r()},1e3*o);window[e]=function(t){window.clearTimeout(i),s(t)};o=document.createElement("script");o.id="colourLoversJSONP",o.type="text/javascript",o.async=!0,o.src=t,document.getElementsByTagName("head")[0].appendChild(o)}p5.prototype.createGradientPalette=({amount:o=5,end:t=this.color(0),start:e=this.color(255)}={})=>{var s=[],r=e,i=t;let l=0;for(let t=0;t<o-1;t++)s.push(this.lerpColor(r,i,l)),l+=1/o;return s.push(i),this.createPalette(s)},p5.prototype.createGrayscalePalette=({amount:t=5,end:o=255,start:e=0}={})=>{(t<2||255<t)&&invalidValue("amount",t);e=this.color(e),o=this.color(o);return this.createGradientPalette({amount:t,end:o,start:e})},p5.prototype.createPalette=t=>{let o=[];return Array.isArray(t)?o=t:("string"==typeof t||t instanceof String)&&t.split("-").forEach(t=>{o.push(this.color("#"+t))}),new Palette(this,o)},p5.prototype.loadRandomColormindPalette=function(o,t){const e=this;p5.prototype.registerPreloadMethod("loadRandomColormindPaletteSync",p5.prototype);const s=new XMLHttpRequest,r=t=>{t=JSON.parse(t.response);if(t.result){const o=e.createPalette();return t.result.forEach(t=>{o.add(e.color(t))}),o}return null};let i=!1;if("function"==typeof o&&(console.log("successCallback is a function!"),i=!0,s.onreadystatechange=function(){var t;4===s.readyState&&200===s.status&&(t=r(s))&&o(t)}),s.open("POST",COLORMIND_API_URL,i),s.send(JSON.stringify({model:"default"})),console.log(s.status),4===s.readyState&&200===s.status){var l=r(s);if(l)return l}},p5.prototype.loadRandomColourLoversPaletteNew2=async function(t,o){p5.prototype.registerPreloadMethod("loadRandomColourLoversPaletteNew2",p5.prototype);var e="http://www.colourlovers.com/api/palettes/random",e=(console.log(e),await this.httpDo(e,"GET","jsonp",{jsonpCallback:"jsonCallback"}));return console.log(e),e[0]},p5.prototype.loadRandomColourLoversPaletteNew=function(t,o){p5.prototype.registerPreloadMethod("loadRandomColourLoversPaletteNew",p5.prototype);const e=this;var s="http://www.colourlovers.com/api/palettes/random?format=json&jsonCallback=callback";console.log(s);let r=!1;"function"==typeof t&&(console.log("successCallback is a function!"),r=!0);let i,l,a=!1;window.callback=function(t){t&&(t=t[0].colors,l=e.createPalette(),t.forEach(t=>{l.add(e.color("#"+t))}),a=!0,console.log("Done is true"))},i=window.setInterval(function(){if(console.log("interval"),console.log(l),a){if(window.clearInterval(i),console.log("Interval cleared"),!r)return l;t(l)}},500);var n=document.createElement("script");n.id="colourLoversJSONP",n.type="text/javascript",n.async=!0,n.src=s,document.getElementsByTagName("head")[0].appendChild(n);let h=0;for(;!a;){if(1e4<h++){console.log("BREAK");break}console.log(h+" waiting")}},p5.prototype.loadRandomColourLoversPalette=function(s){const r=this;var t=COLOURLOVERS_API_URL+r.ceil(r.random(50)),o="callback";t+="&jsonCallback="+o,console.log(t);jsonp(t,{callbackName:o,timeout:5,onSuccess:function(t){if(t){var e=document.getElementById("colourLoversJSONP"),e=(e.parentNode.removeChild(e),console.log(t[0]),t[0].colors);let o=r.createPalette();e.forEach(t=>{o.add(r.color("#"+t))}),s(o)}},onTimeout:function(){console.info("Timeout: failed to retrieve data from API after 5 seconds. Using local colour palette")}})},p5.prototype.storePalette=t=>{t=t.toHexString();let o=this.loadStoredStrings();(o=o||[]).push(t),this.storeItem(STORAGE_KEY,JSON.stringify(o))},p5.prototype.loadStoredPalettes=()=>{var t=this.loadStoredStrings();if(t){const o=[];return t.forEach(t=>{o.push(this.createPalette(t))}),o}return null},p5.prototype.loadStoredStrings=()=>{var t=getItem(STORAGE_KEY);return t?JSON.parse(t):null},p5.prototype.clearStoredPalettes=()=>{this.removeItem(STORAGE_KEY)},p5.prototype.exportStoredPalettes=()=>{let o="const palettes = [";self.loadStoredStrings().forEach(t=>{o+=`'${t}',`}),o=o.slice(0,-1),o+="];",this.saveStrings([o],"exported-palettes","js")};